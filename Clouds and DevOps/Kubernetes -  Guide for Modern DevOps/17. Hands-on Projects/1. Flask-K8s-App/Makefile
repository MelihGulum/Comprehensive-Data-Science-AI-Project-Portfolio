# Variables
IMAGE_NAME=your-docker-hub-username/flask-k8s-app
KUBE_NAMESPACE=default

# Targets
all: login build push start deploy

login:
	@echo ðŸ”‘ Logging in to Docker Hub...
	@echo your-docker-hub-personal-access-token | docker login
	@echo âœ… Successfully logged in to Docker Hub.
	@echo ==========================================

build:
	@echo ðŸ”¨ Building Docker image: $(IMAGE_NAME)...
	docker build -t $(IMAGE_NAME) .
	@echo âœ… Docker image built successfully.
	@echo ==========================================

push:
	@echo ðŸ“¤ Pushing Docker image to Docker Hub: $(IMAGE_NAME)...
	docker push $(IMAGE_NAME)
	@echo âœ… Docker image pushed successfully.
	@echo ==========================================

start:
	@echo ðŸš€ Starting Minikube...
	minikube start
	@echo âœ… Minikube started successfully.
	@echo ==========================================

deploy: start
	@echo ðŸ“¦ Deploying application to Kubernetes in namespace: $(KUBE_NAMESPACE)...
	kubectl apply -f deployment.yaml --namespace $(KUBE_NAMESPACE)
	kubectl apply -f service.yaml --namespace $(KUBE_NAMESPACE)
	@echo âœ… Application deployed successfully.
	@echo ==========================================

clean:
	@echo ðŸ§¹ Cleaning up Kubernetes resources in namespace: $(KUBE_NAMESPACE)...
	kubectl delete -f deployment.yaml --namespace $(KUBE_NAMESPACE)
	kubectl delete -f service.yaml --namespace $(KUBE_NAMESPACE)
	@echo âœ… Cleanup completed.
	@echo ==========================================

.PHONY: all build push start deploy clean
